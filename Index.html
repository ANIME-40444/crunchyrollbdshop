<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crunchyroll Premium BD Shop</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <style>
    body{font-family:'Inter',sans-serif;margin:0;padding:0;background:#131c2b;color:white;}
    header{background:#0a0f1c;padding:20px;text-align:center;}
    header h1{color:#ff9f1c;margin:0;}
    .container{max-width:600px;margin:20px auto;padding:20px;background:#1c2a3a;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,0.5);}
    input,select,button{width:100%;padding:10px;margin:10px 0;border-radius:6px;border:none;font-size:16px;}
    button{background:#ff4081;color:#fff;cursor:pointer;}
    button:hover{background:#e23370;}
    .whatsapp{position:fixed;bottom:20px;right:20px;width:50px;height:50px;border-radius:50%;background:#25D366;display:flex;justify-content:center;align-items:center;}
    .whatsapp img{width:30px;}
    a{color:#ff9f1c;text-decoration:none;}
  </style>
</head>
<body>
  <header><h1>Crunchyroll Premium BD Shop</h1></header>
  <div class="container" id="signup">
    <h2>ЁЯФР рж╕рж╛ржЗржи ржЖржк</h2>
    <input type="email" id="signupEmail" placeholder="ржЗржорзЗржЗрж▓" required>
    <input type="text" id="signupPhone" placeholder="ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░" required>
    <input type="password" id="signupPass" placeholder="ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб" required>
    <input type="password" id="signupConfirm" placeholder="ржХржиржлрж╛рж░рзНржо ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб" required>
    <input type="text" id="signupCity" placeholder="рж╢рж╣рж░" required>
    <button onclick="handleSignup()">рж╕рж╛ржЗржи ржЖржк ЁЯЗзЁЯЗй</button>
  </div>

  <div class="container" id="login" style="display:none;">
    <h2>ЁЯФУ рж╕рж╛ржЗржи ржЗржи</h2>
    <input type="email" id="loginEmail" placeholder="ржЗржорзЗржЗрж▓" required>
    <input type="password" id="loginPass" placeholder="ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб" required>
    <button onclick="handleLogin()">рж╕рж╛ржЗржи ржЗржи ржХрж░рзБржи</button>
  </div>

  <div class="container" id="checkout" style="display:none;">
    <h2>ЁЯЫТ Add to Cart & Order</h2>
    <input type="number" id="amount" placeholder="ржпрзЗ ржПржорж╛ржЙржирзНржЯ ржжрж┐рждрзЗ ржЪрж╛ржи рж▓рж┐ржЦрзБржи (ржпрзЗржоржи:100)">
    <button onclick="startOrder()">ЁЯЫТ Add to Cart</button>
    <form id="orderForm" style="display:none;">
      <input type="text" name="name" placeholder="Full Name" required>
      <input type="email" name="email" placeholder="Email" required>
      <input type="text" name="address" placeholder="Street Address" required>
      <input type="text" name="mobile" placeholder="Mobile Number" required>
      <select name="package">
        <option value="1 Month Share тАУ 100 TK">1 Month тАУ 100 TK</option>
        <option value="2 Months Share тАУ 200 TK">2 Months тАУ 200 TK</option>
        <option value="3 Months Share тАУ 300 TK">3 Months тАУ 300 TK</option>
        <option value="6 Months Share тАУ 600 TK">6 Months тАУ 600 TK</option>
        <option value="8 Months Share тАУ 840 TK">8 Months тАУ 840 TK</option>
      </select>
      <input type="text" name="payment_number" placeholder="Payment Number" required>
      <input type="text" name="trans_id" placeholder="Transaction ID" required>
      <select name="payment_method" required>
        <option value="Bkash">Bkash</option>
        <option value="Nagad">Nagad</option>
        <option value="Rocket">Rocket</option>
      </select>
      <button type="submit">тЬЕ ржЕрж░рзНржбрж╛рж░ ржХржиржлрж╛рж░рзНржо ржХрж░рзБржи</button>
    </form>
  </div>

  <a class="whatsapp" href="https://wa.me/8801305736690" target="_blank">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp">
  </a>

<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyDDvKtm-Mu_12pDLo_9bPvLOusx6YyoYI4",
    authDomain: "crunchyrollpremiumbd-shop.firebaseapp.com",
    projectId: "crunchyrollpremiumbd-shop",
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // EmailJS Init
  emailjs.init("SsUmUorUm-BZG8LBY");
  const adminTemplate = "template_hp66tqp";
  const customerTemplate = "template_1z1lhlf";
  const service = "service_z1714kq";

  function handleSignup(){
    const e=document.getElementById("signupEmail").value.trim();
    const p=document.getElementById("signupPhone").value.trim();
    const pw=document.getElementById("signupPass").value;
    const cpw=document.getElementById("signupConfirm").value;
    const city=document.getElementById("signupCity").value.trim();
    if(pw!==cpw){return alert("Password ржорж┐рж▓ржЫрзЗ ржирж╛");}
    db.collection("users").add({email:e, phone:p, city, timestamp:firebase.firestore.FieldValue.serverTimestamp()})
      .then(()=>{
        alert("тЬЕ рж╕рж╛ржЗржи ржЖржк рж╕ржлрж▓! ржПржЦржи рж▓ржЧржЗржи ржХрж░рзБржиред");
        document.getElementById("signup").style.display="none";
        document.getElementById("login").style.display="block";
      }).catch(err=>alert("Error: "+err));
  }

  function handleLogin(){
    const e=document.getElementById("loginEmail").value.trim();
    db.collection("users").where("email","==",e).get()
      .then(snap=>{
        if(snap.empty){return alert("ржЗржЙржЬрж╛рж░ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐!");}
        document.getElementById("login").style.display="none";
        document.getElementById("checkout").style.display="block";
      });
  }

  function startOrder(){
    const amt=Number(document.getElementById("amount").value);
    if(!amt || amt < 1) return alert("рж╕ржарж┐ржХ ржПржорж╛ржЙржирзНржЯ ржжрж┐ржи!");
    alert(`тЬЕ ржЖржкржирж┐ рз│${amt} ржПрж░ ржкрзНржпрж╛ржХрзЗржЬ ржмрж╛ржЫрж╛ржЗ ржХрж░рзЗржЫрзЗржиред ржирж┐ржЪрзЗ ржкрзВрж░ржг ржХрж░рзБржиред`);
    document.getElementById("amount").disabled=true;
    document.getElementById("orderForm").style.display="block";
  }

  document.getElementById("orderForm").addEventListener("submit",function(e){
    e.preventDefault();
    const data = Object.fromEntries(new FormData(this).entries());
    data.amount = Number(document.getElementById("amount").value);
    data.timestamp = firebase.firestore.FieldValue.serverTimestamp();

    db.collection("orders").add(data)
      .then(doc=>{
        alert("тЬЕ ржЕрж░рзНржбрж╛рж░ рж╕ржлрж▓ржнрж╛ржмрзЗ рж╕рж╛ржмржорж┐ржЯ рж╣рзЯрзЗржЫрзЗ!");
        // Send customer pending email
        emailjs.send(service, customerTemplate, data);
        // Send admin notification
        emailjs.send(service, adminTemplate, data);
        this.reset();
        document.getElementById("amount").value="";
        document.getElementById("orderForm").style.display="none";
        document.getElementById("amount").disabled=false;
      }).catch(err=>alert("тЭМ ржЕрж░рзНржбрж╛рж░ ржмрзНржпрж░рзНрже рж╣рзЯрзЗржЫрзЗ: "+err));
  });
</script>
</body>
</html>
