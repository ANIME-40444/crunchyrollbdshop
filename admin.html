<!DOCTYPE html><html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - Crunchyroll BD Shop</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    .panel {
      max-width: 700px;
      margin: 50px auto;
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    h2 {
      color: #ff6600;
      text-align: center;
    }
    .stat-box {
      display: flex;
      justify-content: space-between;
      margin: 30px 0;
    }
    .stat {
      flex: 1;
      background: #ff6600;
      color: white;
      padding: 20px;
      margin: 10px;
      border-radius: 10px;
      text-align: center;
    }
    .footer {
      text-align: center;
      color: #999;
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <div class="panel">
    <h2>Crunchyroll BD Shop Admin Panel</h2>
    <div class="stat-box">
      <div class="stat">
        <div id="totalOrders">0</div>
        <p>মোট অর্ডার</p>
      </div>
      <div class="stat">
        <div id="totalUsers">0</div>
        <p>মোট ইউজার</p>
      </div>
    </div>
    <div class="footer">আপডেটেড ডেটা দেখার জন্য পেইজটি Reload করুন</div>
  </div>  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSszsZGoe0lXBXOWGktlJ6pYIU6YSIM_SZgLKnsifoa9jAN_jit55vIcOOdXi8yILI5-9i8P-hfIrsv/pub?output=csv";

    fetch(sheetUrl)
      .then(response => response.text())
      .then(data => {
        const rows = data.trim().split('\n');
        const totalOrders = rows.length - 1; // exclude header
        const uniqueUsers = new Set();

        for (let i = 1; i < rows.length; i++) {
          const columns = rows[i].split(',');
          const email = columns[1]; // Assuming column 1 is Email
          uniqueUsers.add(email);
        }

        document.getElementById('totalOrders').innerText = totalOrders;
        document.getElementById('totalUsers').innerText = uniqueUsers.size;
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });
  </script></body>
</html>
